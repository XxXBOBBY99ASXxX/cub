{"version":3,"file":"_a2nbyBlJj5scP7Xn1Nd.js","sources":["../../src/components/ChannelList/ChannelListItem.tsx"],"sourcesContent":["import React, { useContext, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport { ContextMenuContext } from \"../../contexts/ContextMenuContext\";\nimport { modalController } from \"../../controllers/modals\";\nimport { useAppStore } from \"../../stores/AppStore\";\nimport Channel from \"../../stores/objects/Channel\";\nimport { Permissions } from \"../../utils/Permissions\";\nimport Icon from \"../Icon\";\nimport Floating from \"../floating/Floating\";\nimport FloatingTrigger from \"../floating/FloatingTrigger\";\n\nconst ListItem = styled.div<{ isCategory?: boolean }>`\n\tpadding: ${(props) => (props.isCategory ? \"16px 8px 0 0\" : \"1px 8px 0 0\")};\n\tcursor: pointer;\n`;\n\nconst Wrapper = styled.div<{ isCategory?: boolean; active?: boolean }>`\n\tmargin-left: ${(props) => (props.isCategory ? \"0\" : \"8px\")};\n\theight: ${(props) => (props.isCategory ? \"28px\" : \"33px\")};\n\tborder-radius: 4px;\n\talign-items: center;\n\tdisplay: flex;\n\tpadding: ${(props) => (props.isCategory ? \"0 8px 0 8px\" : \"0 16px\")};\n\tbackground-color: ${(props) => (props.active ? \"var(--background-primary-alt)\" : \"transparent\")};\n\tjustify-content: space-between;\n\n\t&:hover {\n\t\tbackground-color: ${(props) => (props.isCategory ? \"transparent\" : \"var(--background-primary-alt)\")};\n\t}\n`;\n\nconst Text = styled.span<{ isCategory?: boolean; hovered?: boolean }>`\n\tfont-size: 16px;\n\tfont-weight: var(--font-weight-regular);\n\twhite-space: nowrap;\n\tcolor: ${(props) => (props.isCategory && props.hovered ? \"var(--text)\" : \"var(--text-secondary)\")};\n\tuser-select: none;\n`;\n\ninterface Props {\n\tchannel: Channel;\n\tisCategory: boolean;\n\tactive: boolean;\n}\n\nfunction ChannelListItem({ channel, isCategory, active }: Props) {\n\tconst app = useAppStore();\n\tconst navigate = useNavigate();\n\tconst contextMenu = useContext(ContextMenuContext);\n\n\tconst [wrapperHovered, setWrapperHovered] = React.useState(false);\n\tconst [createChannelHovered, setCreateChannelHovered] = React.useState(false);\n\tconst [createChannelDown, setChannelCreateDown] = React.useState(false);\n\tconst [hasCreateChannelPermission, setHasCreateChannelPermission] = React.useState(false);\n\n\tuseEffect(() => {\n\t\tif (!isCategory) return;\n\n\t\tconst permission = Permissions.getPermission(app.account!.id, channel.guild, channel);\n\t\tconst hasPermission = permission.has(\"MANAGE_CHANNELS\");\n\t\tsetHasCreateChannelPermission(hasPermission);\n\t}, [channel]);\n\n\treturn (\n\t\t<ListItem\n\t\t\tkey={channel.id}\n\t\t\tisCategory={isCategory}\n\t\t\tonClick={() => {\n\t\t\t\t// prevent navigating to non-text channels\n\t\t\t\tif (!channel.isTextChannel) return;\n\n\t\t\t\tnavigate(`/channels/${channel.guildId}/${channel.id}`);\n\t\t\t}}\n\t\t\tref={contextMenu.setReferenceElement}\n\t\t\tonContextMenu={(e) => contextMenu.onContextMenu(e, { type: \"channel\", channel })}\n\t\t>\n\t\t\t<Wrapper\n\t\t\t\tisCategory={isCategory}\n\t\t\t\tactive={active}\n\t\t\t\tonMouseOver={() => setWrapperHovered(true)}\n\t\t\t\tonMouseOut={() => setWrapperHovered(false)}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\t\tflexDirection: \"row\",\n\t\t\t\t\t\talignItems: \"center\",\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{channel.channelIcon && !isCategory && (\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\ticon={channel.channelIcon}\n\t\t\t\t\t\t\tsize=\"16px\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tmarginRight: \"8px\",\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tcolor=\"var(--text-secondary)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{isCategory && (\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\ticon=\"mdiChevronDown\"\n\t\t\t\t\t\t\tsize=\"12px\"\n\t\t\t\t\t\t\tcolor={wrapperHovered ? \"var(--text)\" : \"var(--text-secondary)\"}\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tmarginRight: \"8px\",\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<Text isCategory={isCategory} hovered={wrapperHovered}>\n\t\t\t\t\t\t{channel.name}\n\t\t\t\t\t</Text>\n\t\t\t\t</div>\n\t\t\t\t{isCategory && hasCreateChannelPermission && (\n\t\t\t\t\t<Floating\n\t\t\t\t\t\tplacement=\"top\"\n\t\t\t\t\t\ttype=\"tooltip\"\n\t\t\t\t\t\toffset={10}\n\t\t\t\t\t\tprops={{\n\t\t\t\t\t\t\tcontent: <span>Create Channel</span>,\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<FloatingTrigger>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tonMouseOver={() => setCreateChannelHovered(true)}\n\t\t\t\t\t\t\t\tonMouseOut={() => setCreateChannelHovered(false)}\n\t\t\t\t\t\t\t\tonMouseDown={() => setChannelCreateDown(true)}\n\t\t\t\t\t\t\t\tonMouseUp={() => setChannelCreateDown(false)}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tif (!channel.guild) {\n\t\t\t\t\t\t\t\t\t\tconsole.warn(\"No guild found for channel\", channel);\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tmodalController.push({\n\t\t\t\t\t\t\t\t\t\ttype: \"create_channel\",\n\t\t\t\t\t\t\t\t\t\tguild: channel.guild,\n\t\t\t\t\t\t\t\t\t\tcategory: channel,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\t\ticon=\"mdiPlus\"\n\t\t\t\t\t\t\t\t\tsize=\"18px\"\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tmarginLeft: \"auto\",\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tcolor={\n\t\t\t\t\t\t\t\t\t\tcreateChannelDown\n\t\t\t\t\t\t\t\t\t\t\t? \"var(--text-header)\"\n\t\t\t\t\t\t\t\t\t\t\t: createChannelHovered\n\t\t\t\t\t\t\t\t\t\t\t? \"var(--text)\"\n\t\t\t\t\t\t\t\t\t\t\t: \"var(--text-secondary)\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</FloatingTrigger>\n\t\t\t\t\t</Floating>\n\t\t\t\t)}\n\t\t\t</Wrapper>\n\t\t</ListItem>\n\t);\n}\n\nexport default ChannelListItem;\n"],"names":["ListItem","styled","props","Wrapper","Text","ChannelListItem","channel","isCategory","active","app","useAppStore","navigate","useNavigate","contextMenu","useContext","ContextMenuContext","wrapperHovered","setWrapperHovered","React","createChannelHovered","setCreateChannelHovered","createChannelDown","setChannelCreateDown","hasCreateChannelPermission","setHasCreateChannelPermission","useEffect","hasPermission","Permissions","jsx","e","jsxs","Icon","Floating","FloatingTrigger","modalController"],"mappings":"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"}