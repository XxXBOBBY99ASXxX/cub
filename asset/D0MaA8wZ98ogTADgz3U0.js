import{u as L,R as f,a9 as R,aa as A,j as e}from"./DEYDuN7xp-m3cL830AkD.js";import{S as I}from"./CW1_sYa28IzwyibYYiTv.js";import{W as P,A as T,S as q,F as U,d as l,L as d,b as h,a as m,c as u,I as y,e as D,f as W,g as H,h as O}from"./CW-ATFYSPDbf9_1tZzUl.js";import{D as V}from"./DQSOHw_SGmJuaIwGBze-.js";import{T as p}from"./D5IfCODi1RtN0YG4PG7p.js";import{H as $}from"./FMJK5WhG_wwNLtUATHA4.js";import{u as K}from"./DMCex30FeWvvThtDj-pY.js";import{u as N}from"./zdDLXtJuoQIQMZlDPq5d.js";import{m as z}from"./BDzl6LkRQpjGU2VD4La_.js";function ae(){const _=N(),b=K("RegistrationPage"),v=L(),[n,S]=f.useState(!1),[k,C]=f.useState(),g=f.useRef(null),{register:o,handleSubmit:E,setValue:c,formState:{errors:r},setError:t,clearErrors:F}=R();o("date_of_birth",{required:!0,pattern:/^\d{4}-\d{2}-\d{2}$/});const x=()=>{var s;(s=g.current)==null||s.resetCaptcha(),c("captcha_key",void 0)},w=E(s=>{r.date_of_birth||(S(!0),C(void 0),c("captcha_key",void 0),_.rest.post(A.register(),{...s,consent:!0}).then(a=>{if("token"in a){_.setToken(a.token,!0);return}else b.error(a),t("email",{type:"manual",message:"Unknown Error"})}).catch(a=>{var i;if("captcha_key"in a){if(a.captcha_key[0]!=="captcha-required")t("email",{type:"manual",message:`Captcha Error: ${a.captcha_key[0]}`});else if(a.captcha_service!=="hcaptcha")t("email",{type:"manual",message:`Unsupported captcha service: ${a.captcha_service}`});else{C(a.captcha_sitekey),(i=g.current)==null||i.execute();return}x()}else if("message"in a){if(a.errors){const j=z(a.errors);j?t(j.field,{type:"manual",message:j.error}):t("email",{type:"manual",message:a.message})}else t("email",{type:"manual",message:a.message});x()}else b.error(a),t("email",{type:"manual",message:"Unknown Error"}),x()}).finally(()=>S(!1)))}),B=s=>{c("captcha_key",s),w()};return k?e.jsx($,{captchaRef:g,sitekey:k,onVerify:B}):e.jsx(P,{children:e.jsxs(T,{children:[e.jsxs(e.Fragment,{children:[e.jsx(I,{height:48,width:"auto"}),e.jsx(q,{noBranding:!0,children:"Create an account"})]}),e.jsxs(U,{onSubmit:w,children:[e.jsxs(l,{marginBottom:!0,style:{marginTop:0},children:[e.jsxs(d,{error:!!r.email,children:[e.jsx(h,{children:"Email"}),r.email&&e.jsx(m,{children:e.jsxs(e.Fragment,{children:[e.jsx(p,{children:"-"}),r.email.message]})})]}),e.jsx(u,{children:e.jsx(y,{type:"email",placeholder:"Email",autoFocus:!0,...o("email",{required:!0}),error:!!r.email,disabled:n})})]}),e.jsxs(l,{marginBottom:!0,style:{marginTop:0},children:[e.jsxs(d,{error:!!r.username,children:[e.jsx(h,{children:"Username"}),r.username&&e.jsx(m,{children:e.jsxs(e.Fragment,{children:[e.jsx(p,{children:"-"}),r.username.message]})})]}),e.jsx(u,{children:e.jsx(y,{...o("username",{required:!0}),placeholder:"Username",error:!!r.username,disabled:n})})]}),e.jsxs(l,{marginBottom:!0,children:[e.jsxs(d,{error:!!r.password,children:[e.jsx(h,{children:"Password"}),r.password&&e.jsx(m,{children:e.jsxs(e.Fragment,{children:[e.jsx(p,{children:"-"}),r.password.message]})})]}),e.jsx(u,{children:e.jsx(y,{type:"password",placeholder:"Password",...o("password",{required:!0}),error:!!r.password,disabled:n})})]}),e.jsxs(l,{marginBottom:!0,children:[e.jsxs(d,{error:!!r.date_of_birth,children:[e.jsx(h,{children:"Date of Birth"}),r.date_of_birth&&e.jsx(m,{children:e.jsxs(e.Fragment,{children:[e.jsx(p,{children:"-"}),r.date_of_birth.message]})})]}),e.jsx(u,{children:e.jsx(V,{onChange:s=>c("date_of_birth",s),onErrorChange:s=>{Object.values(s).some(i=>i)?t("date_of_birth",{type:"manual",message:Object.values(s).filter(i=>i)[0]}):F("date_of_birth")},error:!!r.date_of_birth,disabled:n})})]}),e.jsx(D,{palette:"primary",type:"submit",disabled:n,children:"Create Account"}),e.jsxs(W,{children:[e.jsx(H,{children:"Already have an account?Â "}),e.jsx(O,{onClick:()=>{v("/login")},type:"button",children:"Login"})]})]})]})})}export{ae as R};
//# sourceMappingURL=D0MaA8wZ98ogTADgz3U0.js.map
