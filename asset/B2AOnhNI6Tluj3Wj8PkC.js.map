{"version":3,"file":"B2AOnhNI6Tluj3Wj8PkC.js","sources":["../../src/controllers/banners/BannerController.tsx"],"sourcesContent":["import { AnimatePresence, motion } from \"framer-motion\";\nimport { action, computed, makeObservable, observable } from \"mobx\";\nimport styled from \"styled-components\";\nimport IconButton from \"../../components/IconButton\";\nimport OfflineBanner from \"../../components/banners/OfflineBanner\";\nimport { Banner } from \"./types\";\n\nconst Container = styled(motion.div)`\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n`;\n\nconst CloseWrapper = styled(IconButton)`\n\tposition: absolute;\n\tright: 1%;\n`;\n\nfunction randomUUID() {\n\treturn \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, (c) => {\n\t\t// eslint-disable-next-line no-bitwise\n\t\tconst r = (Math.random() * 16) | 0;\n\t\t// eslint-disable-next-line no-bitwise, no-mixed-operators\n\t\tconst v = c === \"x\" ? r : (r & 0x3) | 0x8;\n\t\treturn v.toString(16);\n\t});\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype Components = Record<string, React.FC<any>>;\n\n/**\n * Handles layering and displaying banners to the user.\n */\nclass BannerController<T extends Banner> {\n\tstack: T[] = [];\n\tcomponents: Components;\n\n\tconstructor(components: Components) {\n\t\tthis.components = components;\n\n\t\tmakeObservable(this, {\n\t\t\tstack: observable,\n\t\t\tpush: action,\n\t\t\tpop: action,\n\t\t\tremove: action,\n\t\t\trendered: computed,\n\t\t\tisVisible: computed,\n\t\t});\n\n\t\tthis.close = this.close.bind(this);\n\t\tthis.closeAll = this.closeAll.bind(this);\n\t}\n\n\t/**\n\t * Display a new banner on the stack\n\t * @param banner banner data\n\t */\n\tpush(banner: T, key?: string) {\n\t\tif (key && this.stack.find((x) => x.key === key)) {\n\t\t\tconsole.warn(`Banner with key '${key}' already exists on the stack!`);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.stack = [\n\t\t\t...this.stack,\n\t\t\t{\n\t\t\t\t...banner,\n\t\t\t\tkey: key ?? randomUUID(),\n\t\t\t},\n\t\t];\n\t}\n\n\t/**\n\t * Remove the top banner from the screen\n\t */\n\tpop() {\n\t\tthis.stack = this.stack.map((entry, index) => (index === this.stack.length - 1 ? entry : entry));\n\t}\n\n\t/**\n\t * Close the top banner\n\t */\n\tclose() {\n\t\tthis.pop();\n\t}\n\n\t/**\n\t * Close all banners on the stack\n\t */\n\tcloseAll() {\n\t\tthis.stack = [];\n\t}\n\n\t/**\n\t * Remove the keyed banner from the stack\n\t */\n\tremove(key: string) {\n\t\tthis.stack = this.stack.filter((x) => x.key !== key);\n\t}\n\n\t/**\n\t * Render banners\n\t */\n\tget rendered() {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{this.stack.map((banner) => {\n\t\t\t\t\tconst Component = this.components[banner.type];\n\t\t\t\t\tif (!Component) return null;\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<AnimatePresence>\n\t\t\t\t\t\t\t<Container\n\t\t\t\t\t\t\t\tvariants={{\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\t// slide down\n\t\t\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\t\t\t\ttransition: {\n\t\t\t\t\t\t\t\t\t\t\tdelayChildren: 0.3,\n\t\t\t\t\t\t\t\t\t\t\tstaggerChildren: 0.2,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\thide: {\n\t\t\t\t\t\t\t\t\t\t// slide up\n\t\t\t\t\t\t\t\t\t\ty: \"-100%\",\n\t\t\t\t\t\t\t\t\t\ttransition: {\n\t\t\t\t\t\t\t\t\t\t\tdelayChildren: 0.3,\n\t\t\t\t\t\t\t\t\t\t\tstaggerChildren: 0.2,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tinitial=\"hide\"\n\t\t\t\t\t\t\t\tanimate=\"show\"\n\t\t\t\t\t\t\t\texit=\"hide\"\n\t\t\t\t\t\t\t\tonAnimationComplete={() => {\n\t\t\t\t\t\t\t\t\tconsole.debug(\"animation complete\");\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t//style={bannerContext.content.style}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Component {...banner} onClose={() => this.remove(banner.key!)} />\n\t\t\t\t\t\t\t\t{/* {!bannerContext.content.forced && (\n\t\t\t\t\t\t\t\t\t<CloseWrapper\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\tbannerContext.close();\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Icon icon=\"mdiClose\" color=\"var(--text)\" size=\"24px\" />\n\t\t\t\t\t\t\t\t\t</CloseWrapper>\n\t\t\t\t\t\t\t\t)} */}\n\t\t\t\t\t\t\t</Container>\n\t\t\t\t\t\t</AnimatePresence>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</>\n\t\t);\n\t}\n\n\t/**\n\t * Whether a banner is currently visible\n\t */\n\tget isVisible() {\n\t\treturn this.stack.length > 0;\n\t}\n}\n\nexport const bannerController = new BannerController({\n\toffline: OfflineBanner,\n});\n"],"names":["Container","styled","motion","IconButton","randomUUID","c","r","BannerController","components","__publicField","makeObservable","observable","action","computed","banner","key","x","entry","index","jsx","Fragment","Component","AnimatePresence","bannerController","OfflineBanner"],"mappings":"wWAOA,MAAMA,EAAYC,EAAOC,EAAO,GAAG;AAAA;AAAA;AAAA;AAAA,EAMdD,EAAOE,CAAU;AAAA;AAAA;AAAA,EAKtC,SAASC,GAAa,CACrB,MAAO,uCAAuC,QAAQ,QAAUC,GAAM,CAErE,MAAMC,EAAK,KAAK,OAAO,EAAI,GAAM,EAG1B,OADGD,IAAM,IAAMC,EAAKA,EAAI,EAAO,GAC7B,SAAS,EAAE,CAAA,CACpB,CACF,CAQA,MAAMC,CAAmC,CAIxC,YAAYC,EAAwB,CAHpCC,EAAA,aAAa,CAAA,GACbA,EAAA,mBAGC,KAAK,WAAaD,EAElBE,EAAe,KAAM,CACpB,MAAOC,EACP,KAAMC,EACN,IAAKA,EACL,OAAQA,EACR,SAAUC,EACV,UAAWA,CAAA,CACX,EAED,KAAK,MAAQ,KAAK,MAAM,KAAK,IAAI,EACjC,KAAK,SAAW,KAAK,SAAS,KAAK,IAAI,CACxC,CAMA,KAAKC,EAAWC,EAAc,CACzB,GAAAA,GAAO,KAAK,MAAM,KAAMC,GAAMA,EAAE,MAAQD,CAAG,EAAG,CACzC,QAAA,KAAK,oBAAoBA,CAAG,gCAAgC,EACpE,MACD,CAEA,KAAK,MAAQ,CACZ,GAAG,KAAK,MACR,CACC,GAAGD,EACH,IAAKC,GAAOX,EAAW,CACxB,CAAA,CAEF,CAKA,KAAM,CACL,KAAK,MAAQ,KAAK,MAAM,IAAI,CAACa,EAAOC,KAAWA,IAAU,KAAK,MAAM,OAAS,EAAID,EAAc,CAChG,CAKA,OAAQ,CACP,KAAK,IAAI,CACV,CAKA,UAAW,CACV,KAAK,MAAQ,EACd,CAKA,OAAOF,EAAa,CACd,KAAA,MAAQ,KAAK,MAAM,OAAQC,GAAMA,EAAE,MAAQD,CAAG,CACpD,CAKA,IAAI,UAAW,CACd,OAEGI,EAAA,IAAAC,EAAA,SAAA,CAAA,SAAA,KAAK,MAAM,IAAKN,GAAW,CAC3B,MAAMO,EAAY,KAAK,WAAWP,EAAO,IAAI,EAC7C,OAAKO,QAEHC,EACA,CAAA,SAAAH,EAAA,IAACnB,EAAA,CACA,SAAU,CACT,KAAM,CAEL,EAAG,EACH,WAAY,CACX,cAAe,GACf,gBAAiB,EAClB,CACD,EACA,KAAM,CAEL,EAAG,QACH,WAAY,CACX,cAAe,GACf,gBAAiB,EAClB,CACD,CACD,EACA,QAAQ,OACR,QAAQ,OACR,KAAK,OACL,oBAAqB,IAAM,CAC1B,QAAQ,MAAM,oBAAoB,CACnC,EAGA,SAAAmB,EAAA,IAACE,EAAW,CAAA,GAAGP,EAAQ,QAAS,IAAM,KAAK,OAAOA,EAAO,GAAI,CAAG,CAAA,CAAA,CAWlE,CAAA,CAAA,EAzCsB,IA2CvB,CAAA,CACF,CAAA,CAEF,CAKA,IAAI,WAAY,CACR,OAAA,KAAK,MAAM,OAAS,CAC5B,CACD,CAEa,MAAAS,EAAmB,IAAIhB,EAAiB,CACpD,QAASiB,CACV,CAAC"}